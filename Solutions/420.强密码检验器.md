# [420. 强密码检验器](https://leetcode-cn.com/problems/strong-password-checker/)

如果一个密码满足下述所有条件，则认为这个密码是强密码：

- 由至少 `6` 个，至多 `20` 个字符组成。
- 至少包含 **一个小写** 字母，**一个大写** 字母，和 **一个数字** 。
- 同一字符 **不能** 连续出现三次 (比如 `"...aaa..."` 是不允许的, 但是 `"...aa...a..."` 如果满足其他条件也可以算是强密码)。

给你一个字符串 `password` ，返回 *将 `password` 修改到满足强密码条件需要的最少修改步数。如果 `password` 已经是强密码，则返回 `0` 。*

在一步修改操作中，你可以：

- 插入一个字符到 `password` ，

- 从 `password` 中删除一个字符，或
- 用另一个字符来替换 `password` 中的某个字符。

**示例 1：**

> 输入：password = "a"
> 输出：5

**示例 2：**

> 输入：password = "aA1"
> 输出：3

**示例 3：**

> 输入：password = "1337C0d3"
> 输出：0

**提示：**

- `1 <= password.length <= 50`
- `password` 由字母、数字、点 `'.'` 或者感叹号 `'!'`

---

## 题目分析

题目的意思很明确，就是做起来复杂

对于一串字符我们只能 **添加删除修改**

使得字符串满足：

1. 长度为6到20
2. 至少包含 **一个小写** 字母，**一个大写** 字母，和 **一个数字**，这3种类型
3. 不能有超三连字符

---

## 解题思路

我们分情况讨论

这里令`n`为**字符串的长度**，`m`为字符串中要求**字符种类的数量**，`l`为**超三连字符的长度**
1. 对于`n<6`的情况，首先要考虑的是**添加**然后再是**替换**

	- **为什么不考虑删除**，因为哪怕你是5个连续的字符，我只要在中间插入一个就会只剩一个三连字符，显然这时候字符串中也只有两种要求字符，于是就需要再替换一个，这样三连字符也就没了
	- **需要添加的字符数量**是可以得出来的，一定是 `6-n`
	- **需要修改的字符数量**同理就是 `3-m`，但是在添加的时候就能进行种类的添加
	- 所以最终最少操作次数最终可以**归纳为 `max(6-n, 3-m)`**
2. 对于 `6<= n <=20` 的情况，主要考虑的是使用**替换**操作

	- 无论是添加还是删除，目的都是减少超三连字符，**都可以被替换操作替代**
	- 对于每一个超三连字符，需要修改的次数就是**l除以3**，**最终的修改次数就是他们的总和**
	- 不可否认的是，在这里也还是需要考虑字符的种类，即修改的次数为 `3-m`
	- 那么最终的次数可以**归纳为 `max(超三连字符的修改次数总和， 3-m)`**
3. 对于 ``n >= 20`` 的情况，主要考虑的是**删除**，然后再考虑**替换**

	- 在情况2中我们分析了，每个超三连字符需要修改的次数就是其长度除以3，**也就是以为着我们每删3个字符可以少一次修改**

	- 于是我们优先删除 `l%3 == 0` 的超三连字符，然后再是` l%3 == 1` 和 `l%3 == 2 `的超三连字符

	- 这里需要使用数组对 `l%3 `的情况进行统计，便于计算

	- 如果在删除之后，n的长度到了20，同时还没有超三连字符了，但是字符种类不达要求，**这时候就还要考虑替换，即`3-m`**

	- 那么最终思路就是先删除，如果删到了n==20没有超三连字符那最终结果就是 `n-20 + 3-m`，如果删到20还有超3连字符，**则采用情况2中的方式进行处理**


---

## 对应代码

这里的代码借用的[宫水三叶老师](https://leetcode-cn.com/u/ac_oier/)的题解 [【宫水三叶】分情况讨论模拟题](https://leetcode-cn.com/problems/strong-password-checker/solution/by-ac_oier-unp5/)的代码

```java
class Solution {
    public int strongPasswordChecker(String password) {
        char[] cs = password.toCharArray();
        int n = cs.length;

        // 计算字符种类
        int A = 0, B = 0, C = 0;
        for (char c : cs) {
            if (c >= 'a' && c <= 'z'){
                A = 1;}
            else if (c >= '0' && c <= '9') {
                B = 1;
            }
            else if (c >= 'A' && c <= 'Z') {
                C = 1;
            }
        }
        int m = A + B + C;

        // 情况1
        if (n < 6) {
            return Math.max(6 - n, 3 - m);
        }
        // 情况2
        else if (n <= 20) {
            // 需要替换的次数
            int tot = 0;
            // 采用双指针的方式求出超三连字符
            for (int i = 0; i < n; ) {
                int j = i;
                while (j < n && cs[j] == cs[i]) {
                    j++;
                }
                int l = j - i;
                if (l >= 3) {
                    tot += l / 3;
                }
                i = j;
            }
            return Math.max(tot, 3 - m);
        }
        else {
            int tot = 0;
            int[] counts = new int[3];
            for (int i = 0; i < n; ) {
                int j = i;
                while (j < n && cs[j] == cs[i]) {
                    j++;
                }
                int l = j - i;
                // 同时统计 需要替换的次数 与 l%3
                if (l >= 3) {
                    tot += l / 3;
                    counts[l % 3]++;
                }
                i = j;
            }
            // base，不管怎么样都要删这么多次
            int base = n - 20, cur = base;
            for (int i = 0; i < 3; i++) {
                // l%3==2 的情况，因为l%3==0和l%3==0的情况在删去只会就会变成l%3==2，同时每改一次等价于删除3次，所以替代
                if (i == 2) {
                    counts[i] = tot;
                }
                if (counts[i] != 0 && cur != 0) {
                    // 对于 l%3==i 的数来说， 要删的个数就是 counts[i] * (i + 1)
                    int t = Math.min(counts[i] * (i + 1), cur);
                    cur -= t;
                    // 每减少一个删去一个 i+1 ，都可以少修改一次
                    tot -= t / (i + 1);
                }
            }
            return base + Math.max(tot, 3 - m);
        }
    }
}
```

![image-20220402150254784](https://pic.livorth.cn/img/image-20220402150254784.png)

---

## 最后

确实是麻烦而又没啥意义的题
